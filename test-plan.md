# 微信登录功能测试计划

## 测试目标
排查 `http://localhost:3001/zh/auth/login` 页面的微信登录功能问题

## 测试环境
- URL: http://localhost:3001/zh/auth/login
- 开发服务器: `pnpm dev`
- 端口: 3001

## 测试步骤

### 1. 基础功能测试

#### 1.1 页面加载测试
- [ ] 访问 http://localhost:3001/zh/auth/login
- [ ] 检查页面是否正常加载
- [ ] 检查中文翻译是否正常显示（不是翻译键）
- [ ] 检查页面布局和样式

#### 1.2 翻译键测试
- [ ] 检查标题是否显示为"欢迎使用AI文案助手"而不是"auth.welcome"
- [ ] 检查描述文本是否正常显示
- [ ] 检查按钮文本是否显示为"微信登录"而不是"auth.wechatLogin"
- [ ] 检查所有UI文本是否使用中文

### 2. 微信登录模态框测试

#### 2.1 模态框打开测试
- [ ] 点击"微信登录"按钮
- [ ] 检查模态框是否正常打开
- [ ] 检查模态框标题是否正常显示
- [ ] 检查模态框内容是否正常显示

#### 2.2 二维码生成测试
- [ ] 检查是否显示"正在生成二维码..."文本
- [ ] 检查二维码是否正常生成
- [ ] 检查二维码URL是否有效
- [ ] 检查是否有错误信息显示

### 3. API 端点测试

#### 3.1 二维码生成API测试
```bash
# 测试二维码生成API
curl -X POST http://localhost:3001/api/auth/wechat/qr \
  -H "Content-Type: application/json" \
  -v
```

#### 3.2 用户资料API测试
```bash
# 测试用户资料API（应该返回401未认证）
curl -X GET http://localhost:3001/api/user/profile \
  -H "Content-Type: application/json" \
  -v
```

### 4. 数据库连接测试

#### 4.1 Supabase连接测试
- [ ] 检查Supabase连接是否正常
- [ ] 检查oauth_sessions表是否存在
- [ ] 检查表权限是否正确设置

#### 4.2 环境变量测试
- [ ] 检查所有必需的环境变量是否设置
- [ ] 检查Supabase URL和密钥是否正确
- [ ] 检查微信应用配置是否正确

### 5. 错误日志分析

#### 5.1 控制台错误检查
- [ ] 检查浏览器控制台是否有JavaScript错误
- [ ] 检查网络请求是否成功
- [ ] 检查API响应状态码

#### 5.2 服务器日志检查
- [ ] 检查开发服务器控制台输出
- [ ] 查找错误日志和警告信息
- [ ] 检查数据库连接错误

### 6. 网络请求测试

#### 6.1 API请求监控
- [ ] 使用浏览器开发者工具监控网络请求
- [ ] 检查请求头是否正确
- [ ] 检查响应数据格式
- [ ] 检查错误响应内容

#### 6.2 跨域问题检查
- [ ] 检查是否有CORS错误
- [ ] 检查请求域名和端口
- [ ] 检查API路由配置

## 预期结果

### 正常情况
1. 页面正常加载，显示中文文本
2. 点击微信登录按钮打开模态框
3. 模态框显示"正在生成二维码..."
4. 二维码正常生成并显示
5. 用户可以扫描二维码进行登录

### 异常情况处理
1. 如果显示翻译键，检查翻译文件配置
2. 如果二维码生成失败，检查API和数据库
3. 如果页面无法加载，检查路由配置
4. 如果API返回错误，检查环境变量和数据库

## 调试工具

### 浏览器开发者工具
- Network 标签页：监控API请求
- Console 标签页：查看JavaScript错误
- Application 标签页：检查本地存储

### 服务器日志
- 开发服务器控制台输出
- API错误日志
- 数据库连接日志

## 修复优先级

1. **高优先级**：翻译键显示问题
2. **高优先级**：二维码生成失败
3. **中优先级**：API端点错误
4. **低优先级**：UI样式问题

## 测试报告模板

### 测试结果
- [ ] 页面加载：通过/失败
- [ ] 翻译显示：通过/失败
- [ ] 模态框打开：通过/失败
- [ ] 二维码生成：通过/失败
- [ ] API请求：通过/失败

### 发现的问题
1. 问题描述：
2. 错误信息：
3. 复现步骤：
4. 预期结果：
5. 实际结果：

### 修复建议
1. 具体修复方案
2. 代码修改建议
3. 配置调整建议
